<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta name="generator" content="HTML Tidy for Linux/x86 (vers 25 March 2009), see www.w3.org" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <title>iSpeech plugins for Asterisk PBX</title>
  <meta name="description" content=
  "Asterisk plugins for the iSpeech TTS and ASR services." />
  <style type="text/css">
/*<![CDATA[*/
    body {
      margin-top: 1.0em;
      background-color: #f6772f;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    #container {
      margin: 0 auto;
      width: 750px;
    }
    h1 { font-size: 3.5em; color: #ffffff; margin-bottom: 3px; }
    h1 .small { font-size: 0.4em; }
    h1 a { text-decoration: none }
    h2 { font-size: 1.5em; color: #ffffff; }
    h3 { text-align: center; color: #ffffff; }
    a { color: #ffffff; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
    pre { background: #000; color: #fff; padding: 15px;}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .footer { text-align:center; padding-top:30px; font-style: italic; }
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  img.c1 {position: absolute; top: 0; right: 0; border: 0;}
  /*]]>*/
  </style>
</head>

<body>
  <a href="https://github.com/zaf/asterisk-ispeech"><img class="c1" src=
  "http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt=
  "Fork me on GitHub" /></a>

  <div id="container">
    <div class="download">
      <a href="https://github.com/zaf/asterisk-ispeech/zipball/master"><img border="0" width=
      "90" src="https://github.com/images/modules/download/zip.png" /></a> <a href=
      "https://github.com/zaf/asterisk-ispeech/tarball/master"><img border="0" width="90" src=
      "https://github.com/images/modules/download/tar.png" /></a>
    </div>

    <h1><a href="https://github.com/zaf/asterisk-ispeech">iSpeech plugins for
    Asterisk</a></h1>

    <div class="description">
	Automatic Speech Recognition and Text To Speech plugins for Asterisk that use the
	<a href="http://www.ispeech.org/">iSpeech API</a>
    </div>

    <p>These AGI scripts make use of <a href="http://www.ispeech.org/">iSpeech API</a> in order to provide ASR and TTS
	capabilities for Asterisk PBX. See <a href=
    "https://raw.github.com/zaf/asterisk-ispeech/master/README">README</a> for a complete list
    of features and supported languages.</p>

    <h2>Dependencies</h2>

    <p>Perl: The Perl Programming Language<br />
    perl-libwww: The World-Wide Web library for Perl<br />
	IO-Socket-SSL: Perl module that implements an interface to SSL sockets<br />
	format_mp3: Asterisk module that supports mp3 playback<br />
    Internet access in order to contact iSpeech servers and get the speech and text data.<br />
    speex: Patent-free audio compression format designed for speech (Optional).</p>

    <h2>Install</h2>

    <p>To install copy ispeech-asr.agi and ispeech-tts.agi to your agi-bin directory.<br />
    Usually this is /var/lib/asterisk/agi-bin/<br />
    To make sure check your /etc/asterisk/asterisk.conf file</p>

    <h2>Usage</h2>
	<h4>TTS:</h4>
    <p><b>agi(ispeech-tts.agi,"text",[voice],[intkey],[speed])</b>:
	This will invoke the iSpeech TTS engine, render the text string to speech and play it
	back to the user. If 'intkey' is set the script will wait for user input.
	Any given interrupt keys will cause the playback to immediately terminate and
	the dialplan to proceed to the matching extension (this is mainly for use in IVR,
	see README for examples). If 'speed' is set the speech rate is altered by that factor.<br />
    <h4>ASR:</h4>
	<p><b>agi(ispeech-asr.agi,[lang],[freeform],[model],[timeout],[intkey],[NOBEEP])</b>:
	Records from the current channel untill 3 seconds of silence are detected
	(this can be set by the user by the 'timeout' argument, -1 for no timeout) or the
	interrupt key (# by default) is pressed. If NOBEEP is set, no beep sound is played
	back to the user to indicate the start of the recording. For 'freeform' and 'model'
	please refer to the ispeech API manual. 'freeform' defaults to 3 (Normal speech)
	The recorded sound is send over to iSpeech ASR service and the
	returned text string is assigned as the value of the channel variable 'utterance'.<br />

	The scripts sets the following channel variables:<br />
    <b>status:</b> Return status. 0 means success, non zero values indicating different
    errors.<br />
    <b>utterance:</b> The generated text string.<br />
    <b>confidence:</b> A value between 0 and 1 indicating the probability of a correct
    recognition.Values bigger than 0.90 usually mean that the resulted text is correct.<br /></p>

    <h4>Asterisk dialplan examples:<br /></h4>
    <pre>
;iSpeech TTS test
exten =&gt; 3,1,Answer()
exten =&gt; 3,n,agi(ispeech-tts.agi,"This is a test of the ispeech text to speech engine in asterisk.")
exten =&gt; 3,n,agi(ispeech-tts.agi,"Esta es una simple prueba en español.",usspanishfemale)
exten =&gt; 3,n,agi(ispeech-tts.agi,"这是一个简单的测试，在中国。有一个愉快的一天。",chchinesefemale)
exten =&gt; 3,n,Hangup()

</pre>
    <pre>
;Speech recognition test
exten =&gt; 4,1,Answer()
exten =&gt; 4,n,agi(ispeech-tts.agi,"Please say something in English. When done press the pound key.")
exten =&gt; 4,n(record),agi(ispeech-asr.agi,en-US)
exten =&gt; 4,n,Noop(== Script returned: ${status} , ${confidence} , ${utterance} ==)
exten =&gt; 4,n,GotoIf($["${status}" = "0"]?success:fail)

exten =&gt; 4,n(success),GotoIf($["${confidence}" &gt; "0.3"]?playback:retry)

exten =&gt; 4,n(retry),agi(ispeech-tts.agi,"Can you please repeat more clearly?")
exten =&gt; 4,n,goto(record)

exten =&gt; 4,n(playback),agi(ispeech-tts.agi,"The text you just said was...")
exten =&gt; 4,n,agi(ispeech-tts.agi,"${utterance}")
exten =&gt; 4,n,goto(end)

exten =&gt; 4,n(fail),agi(ispeech-tts.agi,"Failed to get speech data.")
exten =&gt; 4,n(end),Hangup()

</pre>
    <pre>
;Voice dialing example
exten =&gt; 5,1,Answer()
exten =&gt; 5,n,agi(ispeech-tts.agi,"Please say the number you wish to dial.")
exten =&gt; 5,n(record),agi(ispeech-asr.agi,en-US,,phonenumber)
exten =&gt; 5,n,GotoIf($[$["${status}" = "0"] & $["${confidence}" &gt; "0.3"]]?success:retry)

exten =&gt; 5,(success),agi(ispeech-tts.agi,"Dialing ${utterance}")
exten =&gt; 5,n,goto(${utterance},1)

exten =&gt; 5,n(retry),agi(ispeech-tts.agi,"Can you please repeat?")
exten =&gt; 5,n,goto(record)

</pre>
	<pre>
;IVR test
exten =&gt; 6,1,goto(my_ivr,s,1)

[my_ivr]
exten =&gt; s,1,Answer()
exten =&gt; s,n,Set(TIMEOUT(digit)=5)
exten =&gt; s,n,Set(TIMEOUT(response)=8)
exten =&gt; s,n,agi(ispeech-tts.agi,"Welcome to my small interactive voice response menu.")
exten =&gt; s,n(start),agi(ispeech-tts.agi,"Please dial a digit.",,any)
exten =&gt; s,n,Waitexten()

exten =&gt; _X,1,agi(ispeech-tts.agi,"You just pressed ${EXTEN}. Try another one please.",,any)
exten =&gt; _X,n,Waitexten()

exten =&gt; i,1,agi(ispeech-tts.agi,"Invalid extension.")
exten =&gt; i,n,goto(s,start)

exten =&gt; t,1,agi(ispeech-tts.agi,"Request timed out.")
exten =&gt; t,n,goto(h,1)

</pre><br />


    <h2>License</h2>

    <p>The iSpeech plugins for asterisk are distributed under the GNU General Public License
    v2.</p>

    <h2>Authors</h2>

    <p><a href="http://github.com/zaf">Lefteris Zafiris</a> (zaf@fastmail.com)<br /></p>

    <h2>Download</h2>

    <p>
    Develompent snapshots are available in either <a href=
    "https://github.com/zaf/asterisk-ispeech/zipball/master">zip</a> or <a href=
    "https://github.com/zaf/asterisk-ispeech/tarball/master">tar formats.</a></p><a href=
    "https://github.com/zaf/asterisk-ispeech/tarball/master"></a>

    <p>You can also clone the project with <a href="http://git-scm.com">Git</a> by running:</p>
    <pre>
$ git clone git://github.com/zaf/asterisk-ispeech
</pre>

    <h2>Links</h2>

    <p><a href="http://zaf.github.com/asterisk-googletts/">GoogleTTS text to speech script for
    asterisk</a><br />
	<a href="http://zaf.github.com/asterisk-speech-recog/">Speech Recognition for asterisk using
	Google</a><br />
	<a href="http://zaf.github.com/asterisk-googletranslate/">Text translation using Google Trnanslate
    API for Asterisk</a><br />
    <a href="http://zaf.github.com/asterisk-mstts/">Speech synthesis using Microsoft Translator
    API for Asterisk</a><br />
    <a href="http://zaf.github.com/Asterisk-Flite/">Asterisk Flite text to speech module</a><br />
    <a href="http://zaf.github.com/Asterisk-eSpeak/">Asterisk e-Speak text to speech module</a></p>

    <div class="footer">
      get the source code on GitHub : <a href=
      "https://github.com/zaf/asterisk-ispeech">zaf/asterisk-ispeech</a>
    </div>
  </div>
</body>
</html>
